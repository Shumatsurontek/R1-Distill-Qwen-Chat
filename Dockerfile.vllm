FROM nvidia/cuda:12.1.1-devel-ubuntu22.04

# Installer les dépendances de base
RUN apt update && apt install -y python3 python3-pip git

# Installer vLLM
RUN pip install vllm

# Télécharger le modèle
RUN mkdir -p /models && pip install huggingface_hub && \
    python3 -c "from huggingface_hub import snapshot_download; snapshot_download('deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B', local_dir='/models')"

# Exposer le port
EXPOSE 8000

# Définir le point d'entrée
CMD ["python3", "-m", "vllm.entrypoints.openai.api_server", \
     "--model", "/models", \
     "--host", "0.0.0.0", \
     "--port", "8000"]
